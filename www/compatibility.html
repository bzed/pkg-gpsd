<!doctype html public "-//w3c//dtd html 4.0 transitional//en">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
   <meta name="Description" content="How to survive GPSD API changes">
   <meta name="Keywords" content="GPS, translator, GIS">
   <title>Application Compatibility</title>
   <link rel="stylesheet" href="main.css" type="text/css"/>
</head>
<body>

<div id="Header">Application Compatibility: Surviving GPSD API Changes</div>

<div id="Menu">
    <img src="gpsd-logo-small.png"/><br />
    <a href="index.html">Home</a><br/>
    <a href="index.html#news">News</a><br/>
    <a href="index.html#downloads">Downloads</a><br/>
    <a href="index.html#mailing-lists">Mailing lists</a><br/>
    <a href="index.html#documentation">Documentation</a><br/>
    <a href="faq.html">FAQ</a><br/>
    <a href="xgps-sample.html">Screenshots</a><br/>
    <a href="index.html#recipes">Recipes</a><br/>
    <a href="index.html#others">Other GPSDs</a><br/>
    <a href="hardware.html">Hardware</a><br/>
    <a href="for-vendors.html">For GPS Vendors</a><br/>
    <a href="hall-of-shame.html">Hall of Shame</a><br/>
    Compatibility<br/>
    <a href="hacking.html">Hacker's Guide</a><br/>
    <a href="references.html">References</a><br/>
    <a href="history.html">History</a><br/>

    <div>&nbsp;</div>

    <a href='http://www.catb.org/hacker-emblem/'><img
    src='http://www.catb.org/hacker-emblem/glider.png'
    alt='hacker emblem' /></a><br />

    <hr/>
    <script type="text/javascript"><!--
    google_ad_client = "pub-1458586455084261";
    google_ad_width = 160;
    google_ad_height = 600;
    google_ad_format = "160x600_as";
    google_ad_type = "text";
    google_ad_channel = "";
    //--></script>
    <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
    </script>
    <hr/>

    <a href="http://validator.w3.org/check/referer"><img
          src="http://www.w3.org/Icons/valid-xhtml10"
          alt="Valid XHTML 1.0!" height="31" width="88" /></a>
</div>
<div id="Content">

<p>A day is coming when the application interface of GPSD will have to
change in a major and incompatible way.  This page explains why, and
what you as a GPS-aware application writer can do to be forward- and
backward-compatible when the day comes.</p>

<h2>Why the disruption?</h2>

<p>The design of the <a href="gpsd.html">request/response protocol</a>
that our client libraries use to talk to the daemon is inadequate.  We
are nearly out of room to maneuver around the inadequacies, and fixing
them will require a major break with the past.</p>

<p>The protocol design made sense under the cost constraints of the
mid-1990s when the earliest paleolithic versions of GPSD were first
written, but there are three specific problems with it that have grown
more pressing as the range of GPS-using applications has widened and
the daemon's command set has expaned to match:</p>

<ol>
<li><p>Commands are single letters, and we have about run out of
letters. (This means there's no little or room left to extend the 
command set.)</p></li>

<li><p>There's no way to support returning multiline responses to a
client. (This is a problem for returning things like <a
href="http://gps.wva.net/html.common/rinex.html">RINEX</a> format,
which we'd like to be able to do when a device can report
pseudoranges.)</p>

<li><p>The existing command set encourages sloppy handling of data 
by supporting commands that return PVT and fix-quality information
in atomized partial form, without timestamps.</p> 
</li>
</ol>

<p>Client wrapper libraries like <a href="libgps.html">libgps</a> 
seal off applications from most of the protocol level, but not 
all of it.  In particular, the second argument of
<code>gps_query()</code> is a protocol command string. Thus,
even if the coming transition doesn't change the libgps function-call
signatures in the API, client code will have to change.</p> 

<h2>Minimizing the impact</h2>

<p>The first step to minimizing your exposure is this: <b>Don't talk
directly to GPSD.</b>  Use one of the client libraries we ship
instead; we have one for C, one for Python, and there is a separately
distributed Net::GPSD for Perl. By not doing the response parsing
yourself, you'll avoid having huge amounts of code exposed to the
protocol change.</p>

<p>Each set of client bindings will provide a major and minor
API revision-level symbol.  The final major revision of the
old interface is 3; arguably it should actually 1, but we didn't have
a separate count for minor revisions until this transition was
into the planning stages.</p>

<p>Use the API level to conditionalize your client code. In the best
case, all that will change is <code>gps_query()</code> argument
strings, but we're not sure of that yet.</p>

</div>
<hr/> <script language="JavaScript" src="datestamp.js"
type='text/javascript'></script>
</body>
</html>
<!--
Local Variables:
compile-command: "./upload hacking.html"
End:
-->
