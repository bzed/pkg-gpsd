#!/bin/sh 
#
# Upload gpsd docs
#
webdir=esr@shell.berlios.de:/home/groups/gpsd/htdocs

if [ $1 ]
then
    scp $* $webdir
else
    makeversion=`sed <../Makefile -n -e '/^VERSION *= *\(.*\)/s//\1/p'`

    version=${1:-$makeversion}
    echo "Uploading version $version of gpsd web documents"

    sed -e "/@VERSION@/s//${version}/" -e "/@DATE@/s//`date '+%B %d, %Y'`/" <index.html.in >index.html

    xmlto xhtml-nochunks ../gpsd.xml
    xmlto xhtml-nochunks ../gps.xml
    xmlto xhtml-nochunks ../libgps.xml
    xmlto xhtml-nochunks ../libgpsmm.xml
    xmlto xhtml-nochunks ../libgpsd.xml
    xmlto xhtml-nochunks ../gpsprof.xml
    xmlto xhtml-nochunks ../gpsfake.xml
    xmlto xhtml-nochunks ../gpsctl.xml
    xmlto xhtml-nochunks ../sirfmon.xml
    xmlto xhtml-nochunks ../rtcmdecode.xml
    xmlto xhtml-nochunks ../gpspipe.xml
    xmlto xhtml-nochunks ../gpsflash.xml
    xmlto xhtml-nochunks ../rtcm-104.xml
    xmlto xhtml-nochunks ../srec.xml
    xmlto xhtml-nochunks replacing-nmea.xml
    xmlto xhtml-nochunks writing-a-driver.xml
    (cd performance; xmlto xhtml-nochunks performance.xml)
    scp start-kismet *.html *.png *.pdf *.gif *.css *.js *.txt *.ebuild \
	performance/{*.html,*.txt,*.png} \
	$webdir
    scp axiom/{*.html,*.css,*.pdf,*.jpg,*.doc} $webdir/axiom
fi
